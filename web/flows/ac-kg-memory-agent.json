{
  "id": "ac-kg-memory-agent",
  "name": "AbstractCode KG-Memory Agent (v0)",
  "description": "RunnableFlow agent with KG recall + end-of-turn KG ingestion (extract → assert). Designed for per-turn memory reconstruction experiments.",
  "interfaces": [
    "abstractcode.agent.v1"
  ],
  "nodes": [
    {
      "id": "start",
      "type": "on_flow_start",
      "position": {
        "x": -960.0,
        "y": 0.0
      },
      "data": {
        "nodeType": "on_flow_start",
        "label": "On Flow Start",
        "icon": "&#x1F3C1;",
        "headerColor": "#C0392B",
        "inputs": [],
        "outputs": [
          {
            "id": "exec-out",
            "label": "",
            "type": "execution"
          },
          {
            "id": "use_context",
            "label": "use_context",
            "type": "boolean"
          },
          {
            "id": "memory",
            "label": "memory",
            "type": "memory"
          },
          {
            "id": "context",
            "label": "context",
            "type": "object"
          },
          {
            "id": "provider",
            "label": "provider",
            "type": "provider"
          },
          {
            "id": "model",
            "label": "model",
            "type": "model"
          },
          {
            "id": "system",
            "label": "system",
            "type": "string"
          },
          {
            "id": "prompt",
            "label": "prompt",
            "type": "string"
          },
          {
            "id": "tools",
            "label": "tools",
            "type": "tools"
          },
          {
            "id": "max_iterations",
            "label": "max_iterations",
            "type": "number"
          },
          {
            "id": "max_in_tokens",
            "label": "max_in_tokens",
            "type": "number"
          },
          {
            "id": "temperature",
            "label": "temperature",
            "type": "number"
          },
          {
            "id": "seed",
            "label": "seed",
            "type": "number"
          },
          {
            "id": "resp_schema",
            "label": "resp_schema",
            "type": "object"
          }
        ],
        "pinDefaults": {
          "use_context": true,
          "memory": {},
          "system": "You are a helpful assistant. Use the provided \"## KG ACTIVE MEMORY\" system block (when present) as retrieved memory from a temporal knowledge graph: it contains relevant facts and relationships. When uncertain, ask clarifying questions.\n\nAfter you respond, the workflow will extract durable facts from this turn and assert them into the KG for next-turn recall."
        }
      }
    },
    {
      "id": "memory_default",
      "type": "literal_json",
      "position": {
        "x": -960.0,
        "y": 240.0
      },
      "data": {
        "nodeType": "literal_json",
        "label": "Memory (defaults)",
        "icon": "&#x1F4BE;",
        "headerColor": "#00C49A",
        "inputs": [],
        "outputs": [
          {
            "id": "value",
            "label": "memory",
            "type": "memory"
          }
        ],
        "literalValue": {
          "use_session_attachments": true,
          "use_span_memory": false,
          "use_semantic_search": false,
          "use_kg_memory": true,
          "memory_query": "",
          "memory_scope": "all",
          "recall_level": "standard",
          "max_span_messages": 24,
          "kg_max_input_tokens": 1200,
          "kg_limit": 80,
          "kg_min_score": 0.35,
          "kg_write_scope": "session",
          "kg_domain_focus": "software / agents / memory systems",
          "kg_max_out_tokens": 0
        }
      }
    },
    {
      "id": "memory_effective",
      "type": "merge",
      "position": {
        "x": -736.0,
        "y": 240.0
      },
      "data": {
        "nodeType": "merge",
        "label": "Memory",
        "icon": "&#x1F517;",
        "headerColor": "#00C49A",
        "inputs": [
          {
            "id": "a",
            "label": "a",
            "type": "memory"
          },
          {
            "id": "b",
            "label": "b",
            "type": "memory"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "memory",
            "type": "memory"
          }
        ]
      }
    },
    {
      "id": "mem_write_scope",
      "type": "get",
      "position": {
        "x": -512.0,
        "y": 176.0
      },
      "data": {
        "nodeType": "get",
        "label": "kg_write_scope",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "object",
            "label": "object",
            "type": "object"
          },
          {
            "id": "key",
            "label": "key",
            "type": "string"
          },
          {
            "id": "default",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "any"
          }
        ],
        "pinDefaults": {
          "key": "kg_write_scope",
          "default": "session"
        }
      }
    },
    {
      "id": "mem_domain_focus",
      "type": "get",
      "position": {
        "x": -512.0,
        "y": 256.0
      },
      "data": {
        "nodeType": "get",
        "label": "kg_domain_focus",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "object",
            "label": "object",
            "type": "object"
          },
          {
            "id": "key",
            "label": "key",
            "type": "string"
          },
          {
            "id": "default",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "any"
          }
        ],
        "pinDefaults": {
          "key": "kg_domain_focus",
          "default": "software / agents / memory systems"
        }
      }
    },
    {
      "id": "mem_max_out_tokens",
      "type": "get",
      "position": {
        "x": -512.0,
        "y": 336.0
      },
      "data": {
        "nodeType": "get",
        "label": "kg_max_out_tokens",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "object",
            "label": "object",
            "type": "object"
          },
          {
            "id": "key",
            "label": "key",
            "type": "string"
          },
          {
            "id": "default",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "any"
          }
        ],
        "pinDefaults": {
          "key": "kg_max_out_tokens",
          "default": 0
        }
      }
    },
    {
      "id": "agent",
      "type": "agent",
      "position": {
        "x": -576.0,
        "y": 0.0
      },
      "data": {
        "nodeType": "agent",
        "label": "Agent (KG recall)",
        "icon": "&#x1F916;",
        "headerColor": "#4488FF",
        "inputs": [
          {
            "id": "exec-in",
            "label": "",
            "type": "execution"
          },
          {
            "id": "use_context",
            "label": "use_context",
            "type": "boolean"
          },
          {
            "id": "context",
            "label": "context",
            "type": "object"
          },
          {
            "id": "memory",
            "label": "memory",
            "type": "memory"
          },
          {
            "id": "provider",
            "label": "provider",
            "type": "provider"
          },
          {
            "id": "model",
            "label": "model",
            "type": "model"
          },
          {
            "id": "system",
            "label": "system",
            "type": "string"
          },
          {
            "id": "prompt",
            "label": "prompt",
            "type": "string"
          },
          {
            "id": "tools",
            "label": "tools",
            "type": "tools"
          },
          {
            "id": "max_iterations",
            "label": "max_iterations",
            "type": "number"
          },
          {
            "id": "max_in_tokens",
            "label": "max_in_tokens",
            "type": "number"
          },
          {
            "id": "temperature",
            "label": "temperature",
            "type": "number"
          },
          {
            "id": "seed",
            "label": "seed",
            "type": "number"
          },
          {
            "id": "resp_schema",
            "label": "resp_schema",
            "type": "object"
          }
        ],
        "outputs": [
          {
            "id": "exec-out",
            "label": "",
            "type": "execution"
          },
          {
            "id": "response",
            "label": "response",
            "type": "string"
          },
          {
            "id": "success",
            "label": "success",
            "type": "boolean"
          },
          {
            "id": "meta",
            "label": "meta",
            "type": "object"
          },
          {
            "id": "scratchpad",
            "label": "scratchpad",
            "type": "object"
          }
        ],
        "agentConfig": {
          "provider": "lmstudio",
          "model": "qwen/qwen3-next-80b",
          "tools": [],
          "max_iterations": 25
        }
      }
    },
    {
      "id": "turn_vars",
      "type": "make_object",
      "position": {
        "x": -576.0,
        "y": 240.0
      },
      "data": {
        "nodeType": "make_object",
        "label": "Turn vars",
        "icon": "{}",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "prompt",
            "label": "prompt",
            "type": "string"
          },
          {
            "id": "response",
            "label": "response",
            "type": "string"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "object"
          }
        ]
      }
    },
    {
      "id": "turn_text",
      "type": "string_template",
      "position": {
        "x": -352.0,
        "y": 240.0
      },
      "data": {
        "nodeType": "string_template",
        "label": "Turn transcript",
        "icon": "&#x1F4DD;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "template",
            "label": "template",
            "type": "string"
          },
          {
            "id": "vars",
            "label": "vars",
            "type": "object"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "string"
          }
        ],
        "pinDefaults": {
          "template": "USER: {{prompt}}\\n\\nASSISTANT: {{response}}"
        }
      }
    },
    {
      "id": "kg_sources",
      "type": "code",
      "position": {
        "x": -352.0,
        "y": 384.0
      },
      "data": {
        "nodeType": "code",
        "label": "KG evidence sources",
        "icon": "&#x1F40D;",
        "headerColor": "#9B59B6",
        "inputs": [
          {
            "id": "exec-in",
            "label": "",
            "type": "execution"
          },
          {
            "id": "input",
            "label": "scratchpad",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "exec-out",
            "label": "",
            "type": "execution"
          },
          {
            "id": "output",
            "label": "sources",
            "type": "any"
          }
        ],
        "functionName": "transform",
        "code": "def transform(_input):\n    sp = _input.get('input') if isinstance(_input, dict) else None\n    if not isinstance(sp, dict):\n        return []\n\n    node_traces = sp.get('node_traces')\n    if not isinstance(node_traces, dict):\n        return []\n\n    def _as_dict(v):\n        return v if isinstance(v, dict) else None\n\n    def _safe_str(v):\n        return v if isinstance(v, str) else str(v or '')\n\n    def _stringify(value, *, max_chars):\n        # VisualFlow code nodes disallow imports; use a deterministic repr for structured values.\n        try:\n            if isinstance(value, (dict, list)):\n                s = repr(value)\n            else:\n                s = _safe_str(value)\n        except Exception:\n            s = _safe_str(value)\n        if max_chars and isinstance(max_chars, int) and max_chars > 0 and len(s) > max_chars:\n            return s[: max_chars - 1] + '…'\n        return s\n\n    # Collect tool calls + results across all trace steps.\n    calls = []\n    for trace_any in node_traces.values():\n        trace = _as_dict(trace_any)\n        if not trace:\n            continue\n        steps = trace.get('steps')\n        if not isinstance(steps, list):\n            continue\n        for step_any in steps:\n            step = _as_dict(step_any)\n            if not step:\n                continue\n            effect = _as_dict(step.get('effect')) or {}\n            if _safe_str(effect.get('type')).strip() != 'tool_calls':\n                continue\n            payload = _as_dict(effect.get('payload')) or {}\n            tool_calls = payload.get('tool_calls')\n            if isinstance(tool_calls, dict):\n                tool_calls = [tool_calls]\n            if not isinstance(tool_calls, list):\n                tool_calls = []\n            result = _as_dict(step.get('result')) or {}\n            results = result.get('results')\n            if isinstance(results, dict):\n                results = [results]\n            if not isinstance(results, list):\n                results = []\n            results_by_id = {}\n            for r_any in results:\n                r = _as_dict(r_any)\n                if not r:\n                    continue\n                cid = _safe_str(r.get('call_id')).strip()\n                if cid:\n                    results_by_id[cid] = r\n            for c_any in tool_calls:\n                c = _as_dict(c_any)\n                if not c:\n                    continue\n                cid = _safe_str(c.get('call_id') or c.get('id')).strip()\n                r = results_by_id.get(cid) if cid else None\n                calls.append({'call': c, 'result': r})\n\n    if not calls:\n        return []\n\n    tools_used = []\n    attachment_ids = []\n\n    blocks = ['## Tool outputs']\n    total_chars = 0\n\n    for item in calls:\n        c = item.get('call') if isinstance(item, dict) else None\n        r = item.get('result') if isinstance(item, dict) else None\n        c = c if isinstance(c, dict) else {}\n        r = r if isinstance(r, dict) else {}\n\n        name = _safe_str(c.get('name')).strip() or 'tool'\n        tools_used.append(name)\n        cid = _safe_str(c.get('call_id') or c.get('id')).strip()\n        args = c.get('arguments') if isinstance(c.get('arguments'), dict) else {}\n\n        success = r.get('success') if isinstance(r.get('success'), bool) else None\n        error = r.get('error')\n        output = r.get('output')\n\n        # Best-effort: extract attachment artifact ids.\n        if name == 'open_attachment' and isinstance(output, dict):\n            aid = output.get('artifact_id')\n            aid = _safe_str(aid).strip()\n            if aid:\n                attachment_ids.append(aid)\n\n        entry = []\n        entry.append(f\"- `{name}`\" + (f\" (call_id={cid})\" if cid else ''))\n        entry.append('')\n        entry.append('**arguments**')\n        entry.append('```json')\n        entry.append(_stringify(args, max_chars=2000))\n        entry.append('```')\n        entry.append('')\n        entry.append('**result**')\n        if success is not None:\n            entry.append(f\"- success: {str(success).lower()}\")\n        if error is not None:\n            entry.append(f\"- error: {_safe_str(error)}\")\n        entry.append('```')\n        entry.append(_stringify(output, max_chars=4000))\n        entry.append('```')\n        entry.append('')\n\n        s = '\\n'.join(entry).strip() + '\\n'\n        total_chars += len(s)\n        if total_chars > 24000:\n            blocks.append('_(tool outputs truncated)_')\n            break\n        blocks.append(s)\n\n    tool_outputs_md = '\\n'.join(blocks).strip()\n\n    uniq_tools = []\n    seen = set()\n    for t in tools_used:\n        if t in seen:\n            continue\n        seen.add(t)\n        uniq_tools.append(t)\n\n    summary_lines = [\n        '## Work summary',\n        f\"- tool_calls: {len(calls)}\",\n        f\"- tools: {', '.join(uniq_tools) if uniq_tools else '(none)'}\",\n    ]\n    if attachment_ids:\n        uniq_a = []\n        seen2 = set()\n        for aid in attachment_ids:\n            if aid in seen2:\n                continue\n            seen2.add(aid)\n            uniq_a.append(aid)\n        summary_lines.append(f\"- attachments_used: {', '.join(uniq_a)}\")\n\n    work_summary_md = '\\n'.join(summary_lines).strip()\n\n    sources = [\n        {'source_id': 'tool_outputs', 'kind': 'tool_outputs', 'text': tool_outputs_md},\n        {'source_id': 'work_summary', 'kind': 'work_summary', 'text': work_summary_md},\n    ]\n    if attachment_ids:\n        sources.append({'source_id': 'attachments_used', 'kind': 'attachments_used', 'artifact_ids': attachment_ids, 'text': 'Attachments used:\\n' + '\\n'.join([f\"- {x}\" for x in attachment_ids])})\n\n    return sources\n"
      }
    },
    {
      "id": "ingest_input",
      "type": "make_object",
      "position": {
        "x": -128.0,
        "y": 240.0
      },
      "data": {
        "nodeType": "make_object",
        "label": "KG ingest input",
        "icon": "{}",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "provider",
            "label": "provider",
            "type": "provider"
          },
          {
            "id": "model",
            "label": "model",
            "type": "model"
          },
          {
            "id": "text",
            "label": "text",
            "type": "string"
          },
          {
            "id": "sources",
            "label": "sources",
            "type": "array"
          },
          {
            "id": "scope",
            "label": "scope",
            "type": "string"
          },
          {
            "id": "domain_focus",
            "label": "domain_focus",
            "type": "string"
          },
          {
            "id": "max_out_tokens",
            "label": "max_out_tokens",
            "type": "number"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "object"
          }
        ]
      }
    },
    {
      "id": "kg_ingest",
      "type": "subflow",
      "position": {
        "x": 128.0,
        "y": 0.0
      },
      "data": {
        "nodeType": "subflow",
        "label": "KG ingest (extract → assert)",
        "icon": "&#x1F4E6;",
        "headerColor": "#00CCCC",
        "inputs": [
          {
            "id": "exec-in",
            "label": "",
            "type": "execution"
          },
          {
            "id": "inherit_context",
            "label": "inherit_context",
            "type": "boolean",
            "description": "When true, seed the child run's context.messages from the parent's active context messages. If the pin is not connected, the node checkbox is used. Default: false."
          },
          {
            "id": "input",
            "label": "input",
            "type": "object"
          }
        ],
        "outputs": [
          {
            "id": "exec-out",
            "label": "",
            "type": "execution"
          },
          {
            "id": "output",
            "label": "output",
            "type": "object"
          }
        ],
        "subflowId": "ltm-ai-kg-ingest-turn",
        "pinDefaults": {
          "inherit_context": false
        }
      }
    },
    {
      "id": "kg_ok",
      "type": "get",
      "position": {
        "x": 352.0,
        "y": 176.0
      },
      "data": {
        "nodeType": "get",
        "label": "KG ok",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "object",
            "label": "object",
            "type": "object"
          },
          {
            "id": "key",
            "label": "key",
            "type": "string"
          },
          {
            "id": "default",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "any"
          }
        ],
        "pinDefaults": {
          "key": "ok",
          "default": false
        }
      }
    },
    {
      "id": "kg_count",
      "type": "get",
      "position": {
        "x": 352.0,
        "y": 256.0
      },
      "data": {
        "nodeType": "get",
        "label": "KG count",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "object",
            "label": "object",
            "type": "object"
          },
          {
            "id": "key",
            "label": "key",
            "type": "string"
          },
          {
            "id": "default",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "any"
          }
        ],
        "pinDefaults": {
          "key": "count",
          "default": 0
        }
      }
    },
    {
      "id": "kg_ingest_summary",
      "type": "make_object",
      "position": {
        "x": 576.0,
        "y": 224.0
      },
      "data": {
        "nodeType": "make_object",
        "label": "KG ingest summary",
        "icon": "{}",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "ok",
            "label": "ok",
            "type": "boolean"
          },
          {
            "id": "count",
            "label": "count",
            "type": "number"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "object"
          }
        ]
      }
    },
    {
      "id": "kg_meta",
      "type": "make_object",
      "position": {
        "x": 800.0,
        "y": 224.0
      },
      "data": {
        "nodeType": "make_object",
        "label": "Meta additions",
        "icon": "{}",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "kg_ingest",
            "label": "kg_ingest",
            "type": "object"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "object"
          }
        ]
      }
    },
    {
      "id": "merge_meta",
      "type": "merge",
      "position": {
        "x": 1024.0,
        "y": 224.0
      },
      "data": {
        "nodeType": "merge",
        "label": "Merge meta",
        "icon": "&#x1F517;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "a",
            "label": "a",
            "type": "object"
          },
          {
            "id": "b",
            "label": "b",
            "type": "object"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "object"
          }
        ]
      }
    },
    {
      "id": "success_true",
      "type": "literal_boolean",
      "position": {
        "x": 352.0,
        "y": 352.0
      },
      "data": {
        "nodeType": "literal_boolean",
        "label": "true",
        "icon": "&#x1F7E2;",
        "headerColor": "#00FF00",
        "inputs": [],
        "outputs": [
          {
            "id": "value",
            "label": "value",
            "type": "boolean"
          }
        ],
        "literalValue": true
      }
    },
    {
      "id": "agent_success_coalesce",
      "type": "coalesce",
      "position": {
        "x": 576.0,
        "y": 352.0
      },
      "data": {
        "nodeType": "coalesce",
        "label": "Agent success (default true)",
        "icon": "&#x1F517;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "a",
            "label": "agent_success",
            "type": "any"
          },
          {
            "id": "b",
            "label": "default",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "any"
          }
        ]
      }
    },
    {
      "id": "overall_success",
      "type": "and",
      "position": {
        "x": 800.0,
        "y": 352.0
      },
      "data": {
        "nodeType": "and",
        "label": "Overall success",
        "icon": "&#x1F517;",
        "headerColor": "#3498DB",
        "inputs": [
          {
            "id": "a",
            "label": "agent",
            "type": "any"
          },
          {
            "id": "b",
            "label": "kg",
            "type": "any"
          }
        ],
        "outputs": [
          {
            "id": "result",
            "label": "result",
            "type": "boolean"
          }
        ]
      }
    },
    {
      "id": "end",
      "type": "on_flow_end",
      "position": {
        "x": 1280.0,
        "y": 0.0
      },
      "data": {
        "nodeType": "on_flow_end",
        "label": "On Flow End",
        "icon": "&#x23F9;",
        "headerColor": "#C0392B",
        "inputs": [
          {
            "id": "exec-in",
            "label": "",
            "type": "execution"
          },
          {
            "id": "response",
            "label": "response",
            "type": "string"
          },
          {
            "id": "success",
            "label": "success",
            "type": "boolean"
          },
          {
            "id": "meta",
            "label": "meta",
            "type": "object"
          },
          {
            "id": "scratchpad",
            "label": "scratchpad",
            "type": "object"
          }
        ],
        "outputs": []
      }
    }
  ],
  "edges": [
    {
      "id": "e-start-agent-exec",
      "source": "start",
      "sourceHandle": "exec-out",
      "target": "agent",
      "targetHandle": "exec-in",
      "animated": true
    },
    {
      "id": "e-start-agent-provider",
      "source": "start",
      "sourceHandle": "provider",
      "target": "agent",
      "targetHandle": "provider",
      "animated": false
    },
    {
      "id": "e-start-agent-model",
      "source": "start",
      "sourceHandle": "model",
      "target": "agent",
      "targetHandle": "model",
      "animated": false
    },
    {
      "id": "e-start-agent-prompt",
      "source": "start",
      "sourceHandle": "prompt",
      "target": "agent",
      "targetHandle": "prompt",
      "animated": false
    },
    {
      "id": "e-start-agent-system",
      "source": "start",
      "sourceHandle": "system",
      "target": "agent",
      "targetHandle": "system",
      "animated": false
    },
    {
      "id": "e-start-agent-tools",
      "source": "start",
      "sourceHandle": "tools",
      "target": "agent",
      "targetHandle": "tools",
      "animated": false
    },
    {
      "id": "e-start-agent-use-context",
      "source": "start",
      "sourceHandle": "use_context",
      "target": "agent",
      "targetHandle": "use_context",
      "animated": false
    },
    {
      "id": "e-start-agent-context",
      "source": "start",
      "sourceHandle": "context",
      "target": "agent",
      "targetHandle": "context",
      "animated": false
    },
    {
      "id": "e-start-agent-max-iterations",
      "source": "start",
      "sourceHandle": "max_iterations",
      "target": "agent",
      "targetHandle": "max_iterations",
      "animated": false
    },
    {
      "id": "e-start-agent-max-in-tokens",
      "source": "start",
      "sourceHandle": "max_in_tokens",
      "target": "agent",
      "targetHandle": "max_in_tokens",
      "animated": false
    },
    {
      "id": "e-start-agent-temperature",
      "source": "start",
      "sourceHandle": "temperature",
      "target": "agent",
      "targetHandle": "temperature",
      "animated": false
    },
    {
      "id": "e-start-agent-seed",
      "source": "start",
      "sourceHandle": "seed",
      "target": "agent",
      "targetHandle": "seed",
      "animated": false
    },
    {
      "id": "e-start-agent-resp-schema",
      "source": "start",
      "sourceHandle": "resp_schema",
      "target": "agent",
      "targetHandle": "resp_schema",
      "animated": false
    },
    {
      "id": "e-start-memory-effective-b",
      "source": "start",
      "sourceHandle": "memory",
      "target": "memory_effective",
      "targetHandle": "b",
      "animated": false
    },
    {
      "id": "e-memory-default-memory-effective-a",
      "source": "memory_default",
      "sourceHandle": "value",
      "target": "memory_effective",
      "targetHandle": "a",
      "animated": false
    },
    {
      "id": "e-memory-effective-agent-memory",
      "source": "memory_effective",
      "sourceHandle": "result",
      "target": "agent",
      "targetHandle": "memory",
      "animated": false
    },
    {
      "id": "e-memory-effective-write-scope-object",
      "source": "memory_effective",
      "sourceHandle": "result",
      "target": "mem_write_scope",
      "targetHandle": "object",
      "animated": false
    },
    {
      "id": "e-memory-effective-domain-focus-object",
      "source": "memory_effective",
      "sourceHandle": "result",
      "target": "mem_domain_focus",
      "targetHandle": "object",
      "animated": false
    },
    {
      "id": "e-memory-effective-max-out-tokens-object",
      "source": "memory_effective",
      "sourceHandle": "result",
      "target": "mem_max_out_tokens",
      "targetHandle": "object",
      "animated": false
    },
    {
      "id": "e-start-turn-vars-prompt",
      "source": "start",
      "sourceHandle": "prompt",
      "target": "turn_vars",
      "targetHandle": "prompt",
      "animated": false
    },
    {
      "id": "e-agent-turn-vars-response",
      "source": "agent",
      "sourceHandle": "response",
      "target": "turn_vars",
      "targetHandle": "response",
      "animated": false
    },
    {
      "id": "e-turn-vars-turn-text",
      "source": "turn_vars",
      "sourceHandle": "result",
      "target": "turn_text",
      "targetHandle": "vars",
      "animated": false
    },
    {
      "id": "e-turn-text-ingest-input-text",
      "source": "turn_text",
      "sourceHandle": "result",
      "target": "ingest_input",
      "targetHandle": "text",
      "animated": false
    },
    {
      "id": "e-start-ingest-input-provider",
      "source": "start",
      "sourceHandle": "provider",
      "target": "ingest_input",
      "targetHandle": "provider",
      "animated": false
    },
    {
      "id": "e-start-ingest-input-model",
      "source": "start",
      "sourceHandle": "model",
      "target": "ingest_input",
      "targetHandle": "model",
      "animated": false
    },
    {
      "id": "e-mem-write-scope-ingest-scope",
      "source": "mem_write_scope",
      "sourceHandle": "value",
      "target": "ingest_input",
      "targetHandle": "scope",
      "animated": false
    },
    {
      "id": "e-mem-domain-focus-ingest-domain-focus",
      "source": "mem_domain_focus",
      "sourceHandle": "value",
      "target": "ingest_input",
      "targetHandle": "domain_focus",
      "animated": false
    },
    {
      "id": "e-mem-max-out-tokens-ingest-max-out-tokens",
      "source": "mem_max_out_tokens",
      "sourceHandle": "value",
      "target": "ingest_input",
      "targetHandle": "max_out_tokens",
      "animated": false
    },
    {
      "id": "e-agent-kg-sources-scratchpad",
      "source": "agent",
      "sourceHandle": "scratchpad",
      "target": "kg_sources",
      "targetHandle": "input",
      "animated": false
    },
    {
      "id": "e-agent-kg-ingest-exec",
      "source": "agent",
      "sourceHandle": "exec-out",
      "target": "kg_sources",
      "targetHandle": "exec-in",
      "animated": true
    },
    {
      "id": "e-kg-sources-kg-ingest-exec",
      "source": "kg_sources",
      "sourceHandle": "exec-out",
      "target": "kg_ingest",
      "targetHandle": "exec-in",
      "animated": true
    },
    {
      "id": "e-kg-sources-ingest-input-sources",
      "source": "kg_sources",
      "sourceHandle": "output",
      "target": "ingest_input",
      "targetHandle": "sources",
      "animated": false
    },
    {
      "id": "e-ingest-input-kg-ingest-input",
      "source": "ingest_input",
      "sourceHandle": "result",
      "target": "kg_ingest",
      "targetHandle": "input",
      "animated": false
    },
    {
      "id": "e-kg-ingest-kg-ok-object",
      "source": "kg_ingest",
      "sourceHandle": "output",
      "target": "kg_ok",
      "targetHandle": "object",
      "animated": false
    },
    {
      "id": "e-kg-ingest-kg-count-object",
      "source": "kg_ingest",
      "sourceHandle": "output",
      "target": "kg_count",
      "targetHandle": "object",
      "animated": false
    },
    {
      "id": "e-kg-ok-summary-ok",
      "source": "kg_ok",
      "sourceHandle": "value",
      "target": "kg_ingest_summary",
      "targetHandle": "ok",
      "animated": false
    },
    {
      "id": "e-kg-count-summary-count",
      "source": "kg_count",
      "sourceHandle": "value",
      "target": "kg_ingest_summary",
      "targetHandle": "count",
      "animated": false
    },
    {
      "id": "e-kg-summary-kg-meta",
      "source": "kg_ingest_summary",
      "sourceHandle": "result",
      "target": "kg_meta",
      "targetHandle": "kg_ingest",
      "animated": false
    },
    {
      "id": "e-agent-meta-merge-a",
      "source": "agent",
      "sourceHandle": "meta",
      "target": "merge_meta",
      "targetHandle": "a",
      "animated": false
    },
    {
      "id": "e-kg-meta-merge-b",
      "source": "kg_meta",
      "sourceHandle": "result",
      "target": "merge_meta",
      "targetHandle": "b",
      "animated": false
    },
    {
      "id": "e-agent-success-coalesce-a",
      "source": "agent",
      "sourceHandle": "success",
      "target": "agent_success_coalesce",
      "targetHandle": "a",
      "animated": false
    },
    {
      "id": "e-success-true-coalesce-b",
      "source": "success_true",
      "sourceHandle": "value",
      "target": "agent_success_coalesce",
      "targetHandle": "b",
      "animated": false
    },
    {
      "id": "e-agent-success-overall-a",
      "source": "agent_success_coalesce",
      "sourceHandle": "result",
      "target": "overall_success",
      "targetHandle": "a",
      "animated": false
    },
    {
      "id": "e-kg-ok-overall-b",
      "source": "kg_ok",
      "sourceHandle": "value",
      "target": "overall_success",
      "targetHandle": "b",
      "animated": false
    },
    {
      "id": "e-kg-ingest-end-exec",
      "source": "kg_ingest",
      "sourceHandle": "exec-out",
      "target": "end",
      "targetHandle": "exec-in",
      "animated": true
    },
    {
      "id": "e-agent-end-response",
      "source": "agent",
      "sourceHandle": "response",
      "target": "end",
      "targetHandle": "response",
      "animated": false
    },
    {
      "id": "e-overall-success-end-success",
      "source": "overall_success",
      "sourceHandle": "result",
      "target": "end",
      "targetHandle": "success",
      "animated": false
    },
    {
      "id": "e-merge-meta-end-meta",
      "source": "merge_meta",
      "sourceHandle": "result",
      "target": "end",
      "targetHandle": "meta",
      "animated": false
    },
    {
      "id": "e-agent-end-scratchpad",
      "source": "agent",
      "sourceHandle": "scratchpad",
      "target": "end",
      "targetHandle": "scratchpad",
      "animated": false
    }
  ],
  "entryNode": "start"
}
