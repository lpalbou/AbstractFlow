{
  "id": "ltm-ai-review",
  "name": "ltm-ai-review",
  "description": "Spaced-repetition style review loop: recall memory notes by query/tags, then for each note ask the user to restate/confirm/update. Stores the user's review response as a new durable memory note referencing the original span_id.",
  "interfaces": [],
  "nodes": [
    {
      "id": "node-1",
      "type": "on_flow_start",
      "position": { "x": 96.0, "y": 96.0 },
      "data": {
        "nodeType": "on_flow_start",
        "label": "Start",
        "icon": "&#x1F3C1;",
        "headerColor": "#C0392B",
        "inputs": [],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "query", "label": "query", "type": "string" },
          { "id": "scope", "label": "scope", "type": "string" },
          { "id": "limit", "label": "limit", "type": "number" },
          { "id": "tags", "label": "tags", "type": "object" },
          { "id": "project", "label": "project", "type": "string" }
        ],
        "pinDefaults": {
          "scope": "all",
          "limit": 5,
          "tags": { "topic": "ltm" },
          "project": "abstractframework"
        }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-2",
      "type": "memory_query",
      "position": { "x": 320.0, "y": 96.0 },
      "data": {
        "nodeType": "memory_query",
        "label": "Recall notes",
        "icon": "&#x1F50D;",
        "headerColor": "#2ECC71",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "query", "label": "query", "type": "string" },
          { "id": "limit", "label": "limit", "type": "number" },
          { "id": "tags", "label": "tags", "type": "object" },
          { "id": "tags_mode", "label": "tags_mode", "type": "string" },
          { "id": "usernames", "label": "usernames", "type": "array" },
          { "id": "locations", "label": "locations", "type": "array" },
          { "id": "since", "label": "since", "type": "string" },
          { "id": "until", "label": "until", "type": "string" },
          { "id": "scope", "label": "scope", "type": "string" }
        ],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "results", "label": "results", "type": "array" },
          { "id": "rendered", "label": "rendered", "type": "string" }
        ],
        "pinDefaults": { "tags_mode": "any" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-3",
      "type": "array_length",
      "position": { "x": 544.0, "y": 96.0 },
      "data": {
        "nodeType": "array_length",
        "label": "Count items",
        "icon": "#",
        "headerColor": "#3498DB",
        "inputs": [{ "id": "array", "label": "array", "type": "array" }],
        "outputs": [{ "id": "result", "label": "result", "type": "number" }]
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-4",
      "type": "loop",
      "position": { "x": 320.0, "y": 288.0 },
      "data": {
        "nodeType": "loop",
        "label": "ForEach match",
        "icon": "&#x1F501;",
        "headerColor": "#F39C12",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "items", "label": "items", "type": "array" }
        ],
        "outputs": [
          { "id": "loop", "label": "loop", "type": "execution" },
          { "id": "done", "label": "done", "type": "execution" },
          { "id": "item", "label": "item", "type": "any" },
          { "id": "index", "label": "index", "type": "number" }
        ]
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-5",
      "type": "string_template",
      "position": { "x": 544.0, "y": 288.0 },
      "data": {
        "nodeType": "string_template",
        "label": "Build review prompt",
        "icon": "&#x1F9FE;",
        "headerColor": "#E74C3C",
        "inputs": [
          { "id": "template", "label": "template", "type": "string" },
          { "id": "vars", "label": "vars", "type": "object" }
        ],
        "outputs": [{ "id": "result", "label": "result", "type": "string" }],
        "pinDefaults": {
          "template": "Review memory item\\n\\nSpan: {{span_id}}\\nPreview: {{note_preview}}\\n\\nWithout looking anything else up, restate what you believe is true, and add any corrections/updates (one short paragraph)."
        }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-6",
      "type": "ask_user",
      "position": { "x": 768.0, "y": 288.0 },
      "data": {
        "nodeType": "ask_user",
        "label": "Ask",
        "icon": "&#x2753;",
        "headerColor": "#9B59B6",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "prompt", "label": "prompt", "type": "string" },
          { "id": "choices", "label": "choices", "type": "array" }
        ],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "response", "label": "response", "type": "string" }
        ]
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-7",
      "type": "get",
      "position": { "x": 544.0, "y": 416.0 },
      "data": {
        "nodeType": "get",
        "label": "Get span_id",
        "icon": "&#x1F4E5;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" },
          { "id": "default", "label": "default", "type": "any" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "span_id", "default": "" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-8",
      "type": "make_array",
      "position": { "x": 768.0, "y": 416.0 },
      "data": {
        "nodeType": "make_array",
        "label": "Span ids",
        "icon": "[]",
        "headerColor": "#3498DB",
        "inputs": [{ "id": "a", "label": "a", "type": "any" }],
        "outputs": [{ "id": "result", "label": "result", "type": "array" }]
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-9",
      "type": "literal_json",
      "position": { "x": 960.0, "y": 416.0 },
      "data": {
        "nodeType": "literal_json",
        "label": "Sources",
        "icon": "{}",
        "headerColor": "#00FFFF",
        "inputs": [],
        "outputs": [{ "id": "value", "label": "value", "type": "object" }],
        "literalValue": {}
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-10",
      "type": "set",
      "position": { "x": 1168.0, "y": 416.0 },
      "data": {
        "nodeType": "set",
        "label": "Set sources.span_ids",
        "icon": "&#x1F4E4;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" },
          { "id": "value", "label": "value", "type": "any" }
        ],
        "outputs": [{ "id": "result", "label": "result", "type": "object" }],
        "pinDefaults": { "key": "span_ids" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-11",
      "type": "literal_json",
      "position": { "x": 960.0, "y": 544.0 },
      "data": {
        "nodeType": "literal_json",
        "label": "Base tags",
        "icon": "{}",
        "headerColor": "#00FFFF",
        "inputs": [],
        "outputs": [{ "id": "value", "label": "value", "type": "object" }],
        "literalValue": { "topic": "ltm", "pipeline": "review" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-12",
      "type": "set",
      "position": { "x": 1168.0, "y": 544.0 },
      "data": {
        "nodeType": "set",
        "label": "Set project tag",
        "icon": "&#x1F4E4;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" },
          { "id": "value", "label": "value", "type": "any" }
        ],
        "outputs": [{ "id": "result", "label": "result", "type": "object" }],
        "pinDefaults": { "key": "project" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-13",
      "type": "set",
      "position": { "x": 1376.0, "y": 544.0 },
      "data": {
        "nodeType": "set",
        "label": "Set source_span_id tag",
        "icon": "&#x1F4E4;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" },
          { "id": "value", "label": "value", "type": "any" }
        ],
        "outputs": [{ "id": "result", "label": "result", "type": "object" }],
        "pinDefaults": { "key": "source_span_id" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-14",
      "type": "memory_note",
      "position": { "x": 960.0, "y": 288.0 },
      "data": {
        "nodeType": "memory_note",
        "label": "Store review note",
        "icon": "&#x1F4DD;",
        "headerColor": "#2ECC71",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "keep_in_context", "label": "in_context", "type": "boolean" },
          { "id": "scope", "label": "scope", "type": "string" },
          { "id": "content", "label": "content", "type": "string" },
          { "id": "location", "label": "location", "type": "string" },
          { "id": "tags", "label": "tags", "type": "object" },
          { "id": "sources", "label": "sources", "type": "object" }
        ],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "note_id", "label": "note_id", "type": "string" }
        ],
        "pinDefaults": { "keep_in_context": false, "scope": "session", "location": "flow:ltm-ai-review" }
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    },
    {
      "id": "node-15",
      "type": "on_flow_end",
      "position": { "x": 544.0, "y": 608.0 },
      "data": {
        "nodeType": "on_flow_end",
        "label": "End",
        "icon": "&#x23F9;",
        "headerColor": "#C0392B",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "review_count", "label": "review_count", "type": "number" }
        ],
        "outputs": []
      },
      "label": null,
      "icon": null,
      "headerColor": null,
      "inputs": [],
      "outputs": []
    }
  ],
  "edges": [
    { "id": "edge-1", "source": "node-1", "sourceHandle": "exec-out", "target": "node-2", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-2", "source": "node-1", "sourceHandle": "query", "target": "node-2", "targetHandle": "query", "animated": false },
    { "id": "edge-3", "source": "node-1", "sourceHandle": "limit", "target": "node-2", "targetHandle": "limit", "animated": false },
    { "id": "edge-4", "source": "node-1", "sourceHandle": "tags", "target": "node-2", "targetHandle": "tags", "animated": false },
    { "id": "edge-5", "source": "node-1", "sourceHandle": "scope", "target": "node-2", "targetHandle": "scope", "animated": false },

    { "id": "edge-6", "source": "node-2", "sourceHandle": "results", "target": "node-3", "targetHandle": "array", "animated": false },
    { "id": "edge-7", "source": "node-2", "sourceHandle": "exec-out", "target": "node-4", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-8", "source": "node-2", "sourceHandle": "results", "target": "node-4", "targetHandle": "items", "animated": false },

    { "id": "edge-9", "source": "node-4", "sourceHandle": "item", "target": "node-5", "targetHandle": "vars", "animated": false },
    { "id": "edge-10", "source": "node-5", "sourceHandle": "result", "target": "node-6", "targetHandle": "prompt", "animated": false },
    { "id": "edge-11", "source": "node-4", "sourceHandle": "loop", "target": "node-6", "targetHandle": "exec-in", "animated": true },

    { "id": "edge-12", "source": "node-4", "sourceHandle": "item", "target": "node-7", "targetHandle": "object", "animated": false },
    { "id": "edge-13", "source": "node-7", "sourceHandle": "value", "target": "node-8", "targetHandle": "a", "animated": false },

    { "id": "edge-14", "source": "node-9", "sourceHandle": "value", "target": "node-10", "targetHandle": "object", "animated": false },
    { "id": "edge-15", "source": "node-8", "sourceHandle": "result", "target": "node-10", "targetHandle": "value", "animated": false },

    { "id": "edge-16", "source": "node-11", "sourceHandle": "value", "target": "node-12", "targetHandle": "object", "animated": false },
    { "id": "edge-17", "source": "node-1", "sourceHandle": "project", "target": "node-12", "targetHandle": "value", "animated": false },
    { "id": "edge-18", "source": "node-12", "sourceHandle": "result", "target": "node-13", "targetHandle": "object", "animated": false },
    { "id": "edge-19", "source": "node-7", "sourceHandle": "value", "target": "node-13", "targetHandle": "value", "animated": false },

    { "id": "edge-20", "source": "node-6", "sourceHandle": "exec-out", "target": "node-14", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-21", "source": "node-6", "sourceHandle": "response", "target": "node-14", "targetHandle": "content", "animated": false },
    { "id": "edge-22", "source": "node-13", "sourceHandle": "result", "target": "node-14", "targetHandle": "tags", "animated": false },
    { "id": "edge-23", "source": "node-10", "sourceHandle": "result", "target": "node-14", "targetHandle": "sources", "animated": false },

    { "id": "edge-24", "source": "node-4", "sourceHandle": "done", "target": "node-15", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-25", "source": "node-3", "sourceHandle": "result", "target": "node-15", "targetHandle": "review_count", "animated": false }
  ],
  "entryNode": "node-1",
  "created_at": "2026-01-12T04:15:00.000000",
  "updated_at": "2026-01-12T04:15:00.000000"
}
