{
  "id": "ltm-ai-kg-map-to-active",
  "name": "ltm-ai-kg-map-to-active",
  "description": "Query AbstractMemory triples and map results into a compact, token-budgeted Active Memory text block (\"memory packets\") suitable for injection into an LLM system prompt.",
  "interfaces": [],
  "nodes": [
    {
      "id": "node-1",
      "type": "on_flow_start",
      "position": { "x": 96.0, "y": 96.0 },
      "data": {
        "nodeType": "on_flow_start",
        "label": "Start",
        "icon": "&#x1F3C1;",
        "headerColor": "#C0392B",
        "inputs": [],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "query_text", "label": "query_text", "type": "string" },
          { "id": "scope", "label": "scope", "type": "string" },
          { "id": "min_score", "label": "min_score", "type": "number" },
          { "id": "limit", "label": "limit", "type": "number" },
          { "id": "max_input_tokens", "label": "max_input_tokens", "type": "number" },
          { "id": "model", "label": "model", "type": "model" }
        ],
        "pinDefaults": {
          "scope": "session",
          "min_score": 0.4,
          "limit": 80,
          "max_input_tokens": 2000,
          "model": "qwen/qwen3-next-80b"
        }
      }
    },
    {
      "id": "node-2",
      "type": "memory_kg_query",
      "position": { "x": 384.0, "y": 96.0 },
      "data": {
        "nodeType": "memory_kg_query",
        "label": "KG query",
        "icon": "&#x1F50E;",
        "headerColor": "#8E44AD",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "query_text", "label": "query_text", "type": "string" },
          { "id": "scope", "label": "scope", "type": "string" },
          { "id": "min_score", "label": "min_score", "type": "number" },
          { "id": "max_input_tokens", "label": "max_input_tokens", "type": "number" },
          { "id": "model", "label": "model", "type": "model" },
          { "id": "limit", "label": "limit", "type": "number" }
        ],
        "outputs": [
          { "id": "exec-out", "label": "", "type": "execution" },
          { "id": "raw", "label": "raw", "type": "object" }
        ]
      }
    },
    {
      "id": "node-3",
      "type": "get",
      "position": { "x": 640.0, "y": 48.0 },
      "data": {
        "nodeType": "get",
        "label": "Get active_memory_text",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "active_memory_text" }
      }
    },
    {
      "id": "node-4",
      "type": "get",
      "position": { "x": 640.0, "y": 144.0 },
      "data": {
        "nodeType": "get",
        "label": "Get packets",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "packets" }
      }
    },
    {
      "id": "node-5",
      "type": "get",
      "position": { "x": 640.0, "y": 240.0 },
      "data": {
        "nodeType": "get",
        "label": "Get packed_count",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "packed_count" }
      }
    },
    {
      "id": "node-6",
      "type": "get",
      "position": { "x": 640.0, "y": 336.0 },
      "data": {
        "nodeType": "get",
        "label": "Get dropped",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "dropped" }
      }
    },
    {
      "id": "node-7",
      "type": "get",
      "position": { "x": 640.0, "y": 432.0 },
      "data": {
        "nodeType": "get",
        "label": "Get estimated_tokens",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "estimated_tokens" }
      }
    },
    {
      "id": "node-8",
      "type": "get",
      "position": { "x": 640.0, "y": 528.0 },
      "data": {
        "nodeType": "get",
        "label": "Get ok",
        "icon": "&#x1F50D;",
        "headerColor": "#3498DB",
        "inputs": [
          { "id": "object", "label": "object", "type": "object" },
          { "id": "key", "label": "key", "type": "string" }
        ],
        "outputs": [{ "id": "value", "label": "value", "type": "any" }],
        "pinDefaults": { "key": "ok" }
      }
    },
    {
      "id": "node-9",
      "type": "on_flow_end",
      "position": { "x": 896.0, "y": 96.0 },
      "data": {
        "nodeType": "on_flow_end",
        "label": "End",
        "icon": "&#x23F9;",
        "headerColor": "#C0392B",
        "inputs": [
          { "id": "exec-in", "label": "", "type": "execution" },
          { "id": "active_memory_text", "label": "active_memory_text", "type": "string" },
          { "id": "packets", "label": "packets", "type": "array" },
          { "id": "count", "label": "count", "type": "number" },
          { "id": "dropped", "label": "dropped", "type": "number" },
          { "id": "estimated_tokens", "label": "estimated_tokens", "type": "number" },
          { "id": "ok", "label": "ok", "type": "boolean" }
        ],
        "outputs": []
      }
    }
  ],
  "edges": [
    { "id": "edge-1", "source": "node-1", "sourceHandle": "exec-out", "target": "node-2", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-2", "source": "node-1", "sourceHandle": "query_text", "target": "node-2", "targetHandle": "query_text", "animated": false },
    { "id": "edge-3", "source": "node-1", "sourceHandle": "scope", "target": "node-2", "targetHandle": "scope", "animated": false },
    { "id": "edge-4", "source": "node-1", "sourceHandle": "min_score", "target": "node-2", "targetHandle": "min_score", "animated": false },
    { "id": "edge-5", "source": "node-1", "sourceHandle": "max_input_tokens", "target": "node-2", "targetHandle": "max_input_tokens", "animated": false },
    { "id": "edge-6", "source": "node-1", "sourceHandle": "model", "target": "node-2", "targetHandle": "model", "animated": false },
    { "id": "edge-7", "source": "node-1", "sourceHandle": "limit", "target": "node-2", "targetHandle": "limit", "animated": false },

    { "id": "edge-8", "source": "node-2", "sourceHandle": "raw", "target": "node-3", "targetHandle": "object", "animated": false },
    { "id": "edge-9", "source": "node-2", "sourceHandle": "raw", "target": "node-4", "targetHandle": "object", "animated": false },
    { "id": "edge-10", "source": "node-2", "sourceHandle": "raw", "target": "node-5", "targetHandle": "object", "animated": false },
    { "id": "edge-11", "source": "node-2", "sourceHandle": "raw", "target": "node-6", "targetHandle": "object", "animated": false },
    { "id": "edge-12", "source": "node-2", "sourceHandle": "raw", "target": "node-7", "targetHandle": "object", "animated": false },
    { "id": "edge-13", "source": "node-2", "sourceHandle": "raw", "target": "node-8", "targetHandle": "object", "animated": false },

    { "id": "edge-14", "source": "node-2", "sourceHandle": "exec-out", "target": "node-9", "targetHandle": "exec-in", "animated": true },
    { "id": "edge-15", "source": "node-3", "sourceHandle": "value", "target": "node-9", "targetHandle": "active_memory_text", "animated": false },
    { "id": "edge-16", "source": "node-4", "sourceHandle": "value", "target": "node-9", "targetHandle": "packets", "animated": false },
    { "id": "edge-17", "source": "node-5", "sourceHandle": "value", "target": "node-9", "targetHandle": "count", "animated": false },
    { "id": "edge-18", "source": "node-6", "sourceHandle": "value", "target": "node-9", "targetHandle": "dropped", "animated": false },
    { "id": "edge-19", "source": "node-7", "sourceHandle": "value", "target": "node-9", "targetHandle": "estimated_tokens", "animated": false },
    { "id": "edge-20", "source": "node-8", "sourceHandle": "value", "target": "node-9", "targetHandle": "ok", "animated": false }
  ],
  "entryNode": "node-1"
}
